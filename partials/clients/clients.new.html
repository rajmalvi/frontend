<!--main content start-->
<section class="wrapper site-min-height">
    <!-- page start-->              
    <div class="row">
        <div class="col-md-12">
            <!--progress bar start-->
            <form name="clientForm" ng-init="client_id = 'new'" ng-submit="addClient(clientForm.$valid)">
            <section class="panel client_section">
                <header class="panel-heading">
                    <a href="/clients" class="btn btn-back btn-panel-nav"><i class="fa fa-angle-left" aria-hidden="true"></i></a>
                    <span class="hidden-xs"><a href="/clients">Clients</a> / </span>New Client / {{form_heading}}
                </header>
                <div class="panel-body" ng-form="newClientFormBasic" ng-show="client_form == true">    
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="status">Country<span style="color:red">*</span></label>
                                <ui-select ng-model="search.hotel_country" name="country" theme="bootstrap" on-select="country_change($item)" reset-search-input="true" style="width: 100%;" required>
                                    <ui-select-match allow-clear="true" placeholder="Enter keywords...">{{$select.selected.name}}
                                    </ui-select-match>
                                    <ui-select-choices repeat="country in countries track by $index"
                                                       refresh="searchCountry($select.search)"
                                                       refresh-delay="0">
                                        <div ng-bind-html="country.name | highlight: $select.search"></div>
                                    </ui-select-choices>
                                </ui-select>
                                <label class="form_errors" ng-show="newClientFormBasic.country.$invalid && basicSubmitted == true">Please select a country.</label>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="search_state">State</label>
                                <ui-select ng-model="search.hotel_state" name="state" ng-disabled="search.hotel_country == ''" on-select="state_change($item,$model)" theme="bootstrap" reset-search-input="true" style="width: 100%;">
                                    <ui-select-match allow-clear="true" placeholder="Enter keywords...">{{$select.selected.name}}
                                    </ui-select-match>
                                    <ui-select-choices repeat="state in states track by $index"
                                                       refresh="searchStates($select.search,hotel_details.country)"
                                                       refresh-delay="0">
                                        <div ng-bind-html="state.name | highlight: $select.search"></div>
                                    </ui-select-choices>
                                </ui-select>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="status">City<span style="color:red">*</span></label>
                                <ui-select ng-model="search.hotel_city" ng-disabled="search.hotel_country == ''" name="city" theme="bootstrap" reset-search-input="true" on-select="city_change($item,$model)" style="width: 100%;" required>
                                    <ui-select-match placeholder="Enter keywords...">{{$select.selected.name}}
                                    </ui-select-match>
                                    <ui-select-choices repeat="city in cities track by $index"
                                                       refresh="searchCity($select.search,hotel_details.state)"
                                                       refresh-delay="0">
                                        <div ng-bind-html="city.name | highlight: $select.search"></div>
                                    </ui-select-choices>
                                </ui-select>
                                <label class="form_errors" ng-show="newClientFormBasic.city.$invalid && basicSubmitted == true">Please select a city.</label>
                            </div>
                        </div>
                    </div> 
                    <div ng-show="hotel.name == ''" class="alert alert-info">Please select a hotel to continue</div>
                    <div class="form-group">
                        <label for="hotel">Hotel <span style="color:red">*</span></label>
                        <ui-select ng-model="search.hotel_name" ng-disabled="search.hotel_city == ''" on-select="selectHotel($item,$model)" on-remove="removeHotelFromTemp($item,$model)" name="hotel" theme="bootstrap" reset-search-input="true" style="width: 100%;" required>
                            <ui-select-match placeholder="Enter keywords...">{{$select.selected.name}}</ui-select-match>
                            <ui-select-choices repeat="hotel in hotels track by $index"
                                               refresh="searchHotels($select.search)"
                                               refresh-delay="0">
                                <div ng-bind-html="hotel.formattedName | highlight: $select.search"></div>
                            </ui-select-choices>
                        </ui-select>
                        <label class="form_errors" ng-show="newClientFormBasic.hotel.$invalid && basicSubmitted == true">Please select a hotel.</label>
                    </div>
                    <div ng-show="show_error" class="alert alert-danger">Hotel already added to clients.</div>
                    <div ng-show="show_form == true">
                        <div class="form-group">
                            <label>Property Name<span style="color:red">*</span></label>
                            <input ng-model="newClientAdd.hotel_details.name" type="text" id="name" name="name" class="form-control" placeholder="e.g., hotel" required>
                            <label class="form_errors" ng-show="newClientFormBasic.name.$invalid && basicSubmitted == true">Please enter a property name.</label>
                        </div>

                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label>Address<span style="color:red">*</span></label>
                                    <input type="text" class="form-control" id="us3-address" name="address" ng-model="newClientAdd.hotel_details.address" required>
                                    <label class="form_errors" ng-show="newClientFormBasic.address.$invalid && basicSubmitted == true">Please enter a street address.</label>
                                </div>
                            </div>
                        </div> 
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="status">Country<span style="color:red">*</span></label>
                                    <ui-select ng-model="newClientAdd.hotel_details.country" name="country" theme="bootstrap" on-select="country_change($item)" reset-search-input="true" style="width: 100%;" required>
                                        <ui-select-match placeholder="Enter keywords...">{{$select.selected.name}}</ui-select-match>
                                        <ui-select-choices repeat="country.id as country in countries track by $index"
                                                           refresh="searchCountry($select.search)"
                                                           refresh-delay="0">
                                            <div ng-bind-html="country.name | highlight: $select.search"></div>
                                        </ui-select-choices>
                                    </ui-select>
                                    <label class="form_errors" ng-show="newClientFormBasic.country.$invalid && basicSubmitted == true">Please select a country.</label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="status">State<span style="color:red">*</span></label>
                                    <ui-select ng-model="newClientAdd.hotel_details.state" name="state" on-select="state_change($item,$model)" theme="bootstrap" reset-search-input="true" style="width: 100%;" required>
                                        <ui-select-match placeholder="Enter keywords...">{{$select.selected.name}}
                                        </ui-select-match>
                                        <ui-select-choices repeat="state.id as state in states track by $index"
                                                           refresh="searchStates($select.search,hotel_details.country)"
                                                           refresh-delay="0">
                                            <div ng-bind-html="state.name | highlight: $select.search"></div>
                                        </ui-select-choices>
                                    </ui-select>
                                    <label class="form_errors" ng-show="newClientFormBasic.state.$invalid && basicSubmitted == true">Please select a state.</label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="status">City<span style="color:red">*</span></label>
                                    <ui-select ng-model="newClientAdd.hotel_details.city" name="city" theme="bootstrap" reset-search-input="true"  style="width: 100%;" required>
                                        <ui-select-match placeholder="Enter keywords...">{{$select.selected.name}}
                                        </ui-select-match>
                                        <ui-select-choices repeat="city.id as city in cities track by $index"
                                                           refresh="searchCity($select.search,hotel_details.state)"
                                                           refresh-delay="0">
                                            <div ng-bind-html="city.name | highlight: $select.search"></div>
                                        </ui-select-choices>
                                    </ui-select>
                                    <label class="form_errors" ng-show="newClientFormBasic.city.$invalid && basicSubmitted == true">Please select a city.</label>
                                </div>
                            </div>
                        </div> 
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label>Pincode<span style="color:red">*</span></label>
                                    <input ng-model="newClientAdd.hotel_details.zip" type="number" id="pincode" name="pincode" class="form-control" placeholder="e.g., 411041">
                                    <label class="form_errors" ng-show="newClientFormBasic.pincode.$invalid && basicSubmitted == true">Please enter a pincode.</label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="manager">Account Manager <span style="color:red">*</span></label>
                                    <ui-select ng-model="newClientAdd.account_manager" theme="bootstrap" reset-search-input="true" style="width: 100%;" name="account_manager" id="account_manager" ng-required="true">
                                        <ui-select-match placeholder="Enter keywords...">{{$select.selected.formatted_name}}</ui-select-match>
                                        <ui-select-choices repeat="manager.account_id as manager in managers track by $index"
                                                           refresh="searchAccountManager($select.search)"
                                                           refresh-delay="3">
                                            <div ng-bind-html="manager.formatted_name | highlight: $select.search"></div>
                                        </ui-select-choices>
                                    </ui-select>
                                    <label class="form_errors" ng-show="newClientFormBasic.account_manager.$invalid && basicSubmitted == true">Please select an account manager.</label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label>Hotel Capacity<span style="color:red">*</span></label>
                                    <input ng-model="newClientAdd.hotel_details.max_capacity" type="number" id="max_capacity" name="max_capacity" class="form-control" placeholder="e.g., 100" required>
                                    <label class="form_errors" ng-show="newClientFormBasic.max_capacity.$invalid && basicSubmitted == true">Please enter hotel capacity</label>
                                </div>
                            </div>
                        </div> 
                        <div class="form-group">
                            <div class="row">
                                <div class="col-md-4">
                                    <label>Hotel Flag<span style="color:red">*</span></label>
                                    <select ng-model="newClientAdd.hotel_details.flag" id="flag" name="flag" class="form-control" required>
                                        <option value="">Select</option>
                                        <option value="Blue">Blue</option>
                                        <option value="Green">Green</option>
                                        <option value="Yellow">Yellow</option>
                                        <option value="Red">Red</option>
                                    </select>
                                    <label class="form_errors" ng-show="newClientFormBasic.flag.$invalid && basicSubmitted == true">Please select a flag.</label>
                                </div>
                                <div class="col-md-4">
                                    <label>Hotel Type<span style="color:red">*</span></label>
                                    <select ng-model="newClientAdd.hotel_details.type" id="type" name="type" class="form-control" required>
                                        <option value="">Select</option>
                                        <option value="Leisure">Leisure</option>
                                        <option value="Business">Business</option>
                                    </select>
                                    <label class="form_errors" ng-show="newClientFormBasic.type.$invalid && basicSubmitted == true">Please select a type.</label>
                                </div>
                                <div class="col-md-4">
                                    <label>Yield Type<span style="color:red">*</span></label>
                                    <select ng-model="newClientAdd.hotel_details.yield" id="yield" name="yield" class="form-control" required>
                                        <option value="">Select</option>
                                        <option value="Volume">Volume</option>
                                        <option value="Revenue">Revenue</option>
                                    </select>
                                    <label class="form_errors" ng-show="newClientFormBasic.yield.$invalid && basicSubmitted == true">Please select a yield type.</label>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-12">
                                <div id="us3" style="height: 400px;"></div>
                                <div class="clearfix">&nbsp;</div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="compititors">Competitors<span style="color:red">*</span></label>
                            <ui-select ng-model="newClientAdd.competitors" multiple theme="bootstrap" close-on-select="false" reset-search-input="true" name="competitors" on-select="selectCompetitor($item,$model)" on-remove="removeHotelFromTemp($item,$model)" required class="uiselect_css">
                                <ui-select-match placeholder="Enter keywords...">{{$item.name}}</ui-select-match>
                                <ui-select-choices repeat="hotel.id as hotel in hotels track by $index"
                                                   refresh="searchHotels($select.search,true)"
                                                   refresh-delay="0">
                                    <div ng-bind-html="hotel.formatted_name | highlight: $select.search"></div>
                                </ui-select-choices>
                            </ui-select>
                            <label class="form_errors" ng-show="newClientFormBasic.hotel.$invalid && basicSubmitted == true">Please select at least 1 competitor.</label>
                        </div>
                    </div> 
                    <button type="button" ng-show="!show_error" ng-click="client_form_next(newClientFormBasic.$valid)" class="btn btn-primary pull-right" style="margin-right:3px;">Next</button>

                </div>

                <div class="panel-body" ng-form="clientFormRateshopping" ng-show="run_rate_shop == true">   
                    <div class="row">
                        <div class="col-md-6 col-lg-6">
                            <div class="panel">
                                <div class="panel-heading">Run Rate Shop</div>
                                <div class="panel-body">
                                    <div class="alert alert-info">Run Rate Shop to fetch room types</div>
                                    <div ng-show="fetchingRates" class="text-left">
                                        <div class="alert alert-warning">Please wait while rates and room types are being fetched. Don't move!</div>
                                        <p ng-show="queued" style="margin-bottom: 0px;">Approx. Time Remaining</p>
                                        <div style="font-size: 40px; font-weight: bold;" id="countdown"></div>
                                    </div>
                                    <div ng-show="fetchSubmitted && !fetchedRates && !fetchingRates" class="alert alert-danger">Please run rate shop to detect room types before you continue.</div>
                                    <div ng-show="fetchSubmitted && fetchingRates" class="alert alert-warning">Rates are being fetched. Please wait until the process is complete.</div>
                                    <div ng-show="fetchedRates && !fetchingRates" class="alert alert-success">Room types have been fetched. You can do the mapping in next step.</div>
                                    <button type="button" ng-hide="fetchingRates || fetchedRates" class="btn btn-primary" ng-click="postRunRate()">Run Rate Shop</button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-6">
                            <div class="panel">
                                <div class="panel-heading">Upload Historical Data</div>
                                <div class="panel-body">
                                    <div class="form-group">
                                        <div class="alert alert-info">Select bookings file from channel manager</div>
                                        <button class="btn btn-primary">Select File</button>
                                    </div>
                                    <div ng-show="fetchSubmitted && fetchingRates" class="alert alert-danger">Please upload historically data dump from the channel manager.</div>
                                    <div ng-show="fetchSubmitted && fetchingRates" class="alert alert-warning">Please wait while data dump from channel manager is being processed.</div>
                                    <button class="btn btn-primary pull-right" ng-click="uploadBookingFile()">Upload</button>
                                </div>
                            </div>
                        </div>
                         </div>
                        <button type="button" class="btn btn-primary pull-right" ng-click="run_rate_shop_next()" style="margin-right:3px;">Next</button>
                        <button type="button" class="btn btn-danger pull-right" ng-click="run_rate_shop_back()" style="margin-right:3px;">Back</button>
                   
                </div>

                <div class="panel-body" ng-show="mapping_forms == true">   
                    <div class="row">
                        <div class="col-md-12 col-lg-12">
                            <div class="panel">
                                    <div class="panel-heading pr1">
                                         <ul>
                                            <li>Room Type Mappings</li>
                                            <li ng-click="roomTypeModal(true)"><a class="btn btn-primary btn-xs mbr" style="margin-left: 10px;"><i class="fa fa-plus"></i> New Mapping </a></li>
                                        </ul>
                                    </div>
                                    <div class="panel-body">
                                        <table class="table table-striped">
                                            <thead>
                                                <tr>
                                                    <th>Sr. No.</th>
                                                    <th>Hotel Name</th>
                                                    <th>Source Room Type</th>
                                                    <th>System Room Type</th>
                                                    <th>Source</th>
                                                    <th>Capacity</th>
                                                    <th>Action</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr ng-repeat="rt in newClientAdd.roomtypes">
                                                    <td>{{$index+1}}</td>
                                                    <td>{{rt.hotel_name|ucwords}}</td>
                                                    <td>{{rt.name|ucwords}}</td>
                                                    <td>{{rt.system_record.name|ucwords}}</td>
                                                    <td>
                                                        <span ng-show="rt.type != 'staah'">
                                                            {{rt.type|ucwords}}
                                                        </span>
                                                        <span ng-show="rt.type == 'staah'">
                                                            {{rt.type|uppercase}}
                                                        </span>
                                                    </td>
                                                    <td>{{rt.capacity}}</td>
                                                    <td>
                                                        <button class="btn btn-info btn-xs" ng-click="editRoomTypeModal(rt,true,$index)" type="button"><i class="fa fa-edit"></i></button><button class="btn btn-danger btn-xs" ng-click="setupRemoveRoomType($index)" type="button" style="margin-left:5px;"><i class="fa fa-trash-o"></i></button>
                                                    </td>
                                                </tr>
                                                <tr ng-show="newClientAdd.roomtypes.length == 0"><td colspan="6">No room types have been mapped yet.</td></tr>
                                            </tbody>
                                        </table>
                                </div>
                        </div>
                        </div>
                        </div>
                    <div class="row">
                        <div class="col-md-12 col-lg-12">
                            <div class="panel">
                                   <div class="panel-heading pr1">
                                         <ul>
                                            <li>OTA Mappings</li>
                                            <li ng-click="otaModal(true)"><a class="btn btn-primary btn-xs mbr" style="margin-left: 10px;"><i class="fa fa-plus"></i> New Mapping </a></li>
                                        </ul>
                                    </div>
                                     <div class="panel-body">
                                        <table class="table table-striped">
                                            <thead>
                                                <tr>
                                                    <th>Sr. No.</th>
                                                    <th>Hotel Name</th>
                                                    <th>Client OTA</th>
                                                    <th>System OTA</th>
                                                    <th>Type</th>
                                                    <th>Action</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr ng-repeat="ota_data in newClientAdd.otas.staah">
                                                    <td>{{$index+1}}</td>
                                                    <td>{{ota_data.hotel_name}}</td>
                                                    <td>{{ota_data.client_ota|ucwords}}</td>
                                                    <td>{{ota_data.system_name|ucwords}}</td>
                                                    <td>
                                                        <span ng-show="ota_data.type != 'staah'">
                                                            {{ota_data.type|ucwords}}
                                                        </span>
                                                        <span ng-show="ota_data.type == 'staah'">
                                                            {{ota_data.type|uppercase}}
                                                        </span>
                                                    </td>
                                                    <td><button type="button" class="btn btn-info btn-xs" ng-click="editOtaModal(ota_data,true)"><i class="fa fa-edit"></i></button><button type="button" class="btn btn-danger btn-xs" ng-click="setupRemoveOTA($index)" style="margin-left:5px;"><i class="fa fa-trash-o"></i></button></td>
                                                </tr>
                                                <tr ng-show="newClientAdd.otas.staah.length == 0"><td colspan="6">No OTAs have been mapped for the channel manager.</td></tr>
                                            </tbody>
                                        </table>
                                  </div>   
                            </div>
                        </div>
                    </div>
                    
                    <button type="button" class="btn btn-primary pull-right" ng-click="mapping_forms_next()" style="margin-right:3px;">Next</button>
                    <button type="button" class="btn btn-danger pull-right" ng-click="mapping_forms_back()" style="margin-right:3px;">Back</button>
                </div>

                <div class="panel-body" ng-form="presetting_form" ng-show="rateshop_form == true">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="panel">
                                <div class="panel-heading">Client Rate Shop Settings</div>
                                <div class="panel-body">

                                    <div class="form-group">
                                        <label for="los">OTAs<span style="color:red">*</span></label>
                                        <ui-select ng-model="newClientAdd.rateshop.client.otas" multiple name="client_otas" theme="bootstrap" close-on-select="true" reset-search-input="true" class="uiselect_css" required>
                                            <ui-select-match placeholder="Enter keywords...">{{$item.name}}</ui-select-match>
                                            <ui-select-choices repeat="ota_name.id as ota_name in otas_name track by $index"
                                                               refresh="searchOTAs_new($select.search)"
                                                               refresh-delay="0">
                                                <div ng-bind-html="ota_name.name | highlight: $select.search"></div>
                                            </ui-select-choices>
                                        </ui-select>
                                        <label class="form_errors" ng-show="presetting_form.client_otas.$invalid && prefetchSubmitted == true">Please select at least 1 OTA.</label>
                                    </div>
                                    <div class="">
                                        <label>Schedule & Horizon</label>
                                        <table class="table table-striped table-bordered" style="margin-bottom:0;">
                                            <tr>
                                                <td ng-repeat="day in days.get_day_two">
                                                    <div class="col-md-2" style="margin-left: -15px;">
                                                        <input class="day_check" ng-model="newClientAdd.rateshop.client.horizon[$index].dow" type="checkbox"/>
                                                    </div>
                                                    <div class="col-md-3" style="margin-top: 3px;">
                                                        <label class="day_label">{{day}}</label>
                                                    </div>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <input ng-model="newClientAdd.rateshop.client.horizon[0].days" ng-disabled="!newClientAdd.rateshop.client.horizon[0].dow" type="text" class="form-control" name="horizon" ng-pattern="/^[0-9]*$/" />
                                                </td>
                                                <td>
                                                    <input ng-model="newClientAdd.rateshop.client.horizon[1].days" ng-disabled="!newClientAdd.rateshop.client.horizon[1].dow" type="text" class="form-control" name="horizon1" ng-pattern="/^[0-9]*$/" />
                                                </td>
                                                <td>
                                                    <input ng-model="newClientAdd.rateshop.client.horizon[2].days" ng-disabled="!newClientAdd.rateshop.client.horizon[2].dow" type="text" class="form-control" name="horizon2" ng-pattern="/^[0-9]*$/" />
                                                </td>
                                                <td>
                                                    <input ng-model="newClientAdd.rateshop.client.horizon[3].days" ng-disabled="!newClientAdd.rateshop.client.horizon[3].dow" type="text" class="form-control" name="horizon3" ng-pattern="/^[0-9]*$/" />
                                                </td>
                                                <td>
                                                    <input ng-model="newClientAdd.rateshop.client.horizon[4].days" ng-disabled="!newClientAdd.rateshop.client.horizon[4].dow" type="text" class="form-control" name="horizon4" ng-pattern="/^[0-9]*$/" />
                                                </td>
                                                <td>
                                                    <input ng-model="newClientAdd.rateshop.client.horizon[5].days" ng-disabled="!newClientAdd.rateshop.client.horizon[5].dow" type="text" class="form-control" name="horizon5" ng-pattern="/^[0-9]*$/" />
                                                </td>
                                                <td>
                                                    <input ng-model="newClientAdd.rateshop.client.horizon[6].days" ng-disabled="!newClientAdd.rateshop.client.horizon[6].dow" type="text" class="form-control" name="horizon6" ng-pattern="/^[0-9]*$/" />
                                                </td>
                                            </tr>
                                        </table>
                                        <label for="horizon" class="form_errors" ng-show="(presetting_form.horizon.$invalid && !presetting_form.horizon.$pristine) || (presetting_form.horizon1.$invalid && !presetting_form.horizon1.$pristine) || (presetting_form.horizon2.$invalid && !presetting_form.horizon2.$pristine) || (presetting_form.horizon3.$invalid && !presetting_form.horizon3.$pristine) || (presetting_form.horizon4.$invalid && !presetting_form.horizon4.$pristine) || (presetting_form.horizon5.$invalid && !presetting_form.horizon5.$pristine) || (presetting_form.horizon6.$invalid && !presetting_form.horizon6.$pristine)">Please enter only digits</label>
                                    </div>
                                </div>
                            </div>
                            <hr />

                            <div class="panel">
                                <div class="panel-heading">Common Settings</div>
                                <div class="panel-body">

                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label>LOS<span style="color:red">*</span></label>
                                                <input type="number" min="1" required ng-model="newClientAdd.rateshop.los" placeholder="Enter number" ng-pattern="/^[0-9]*$/" id="los" name="los" class="form-control"/>
                                                <label for="los" class="form_errors" ng-show="presetting_form.los.$invalid && prefetchSubmitted">Please enter a valid LOS</label>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label>Currency<span style="color:red">*</span></label>
                                                <ui-select ng-model="newClientAdd.rateshop.currency" name="currency" theme="bootstrap" reset-search-input="false" required style="width: 100%;">
                                                    <ui-select-match placeholder="Enter currency">{{$select.selected.iso}}</ui-select-match>
                                                    <ui-select-choices repeat="curr in currency track by $index"
                                                                       refresh="searchCurrency($select.search)"
                                                                       refresh-delay="0">
                                                        <div ng-bind-html="curr.iso | highlight: $select.search"></div>
                                                    </ui-select-choices>
                                                </ui-select>
                                                <label for="currency" class="form_errors" ng-show="presetting_form.currency.$invalid && prefetchSubmitted">Please select a currency</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="panel">
                                <div class="panel-heading">Competitors Rate Shop Settings</div>
                                <div class="panel-body">

                                    <div class="form-group">
                                        <label for="los">OTAs<span style="color:red">*</span></label>
                                        <ui-select ng-model="newClientAdd.rateshop.competitors.otas" multiple name="comp_otas" theme="bootstrap" reset-search-input="true" close-on-select="true" class="uiselect_css" required>
                                            <ui-select-match placeholder="Enter keywords...">{{ $item.name}}</ui-select-match>
                                            <ui-select-choices repeat="ota_name.id as ota_name in otas_name track by $index"
                                                               refresh="searchOTAs_new($select.search)"
                                                               refresh-delay="0">
                                                <div ng-bind-html="ota_name.name | highlight: $select.search"></div>
                                            </ui-select-choices>
                                        </ui-select>
                                        <label class="form_errors" ng-show="presetting_form.comp_otas.$invalid && prefetchSubmitted == true">Please select at least 1 OTA.</label>
                                    </div>
                                    <div class="">
                                        <label>Schedule & Horizon</label>
                                        <table class="table table-striped table-bordered" style="margin-bottom: 0;">
                                            <tr>
                                                <td ng-repeat="day in days.get_day_two">
                                                    <div class="col-md-2" style="margin-left: -15px;">
                                                        <input class="day_check" ng-model="newClientAdd.rateshop.competitors.horizon[$index].dow" value="{{ day}}" type="checkbox"/>
                                                    </div>
                                                    <div class="col-md-3" style="margin-top: 3px;">
                                                        <label class="day_label">{{day}}</label>
                                                    </div>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <input ng-model="newClientAdd.rateshop.competitors.horizon[0].days" ng-disabled="!newClientAdd.rateshop.competitors.horizon[0].dow" type="text" class="form-control" name="horizon11" ng-pattern="/^[0-9]*$/"/>
                                                </td>
                                                <td>
                                                    <input ng-model="newClientAdd.rateshop.competitors.horizon[1].days" ng-disabled="!newClientAdd.rateshop.competitors.horizon[1].dow" type="text" class="form-control" name="horizon12" ng-pattern="/^[0-9]*$/"/>
                                                </td>
                                                <td>
                                                    <input ng-model="newClientAdd.rateshop.competitors.horizon[2].days" ng-disabled="!newClientAdd.rateshop.competitors.horizon[2].dow" type="text" class="form-control" name="horizon13" ng-pattern="/^[0-9]*$/"/>
                                                </td>
                                                <td>
                                                    <input ng-model="newClientAdd.rateshop.competitors.horizon[3].days" ng-disabled="!newClientAdd.rateshop.competitors.horizon[3].dow" type="text" class="form-control" name="horizon14" ng-pattern="/^[0-9]*$/"/>
                                                </td>
                                                <td>
                                                    <input ng-model="newClientAdd.rateshop.competitors.horizon[4].days" ng-disabled="!newClientAdd.rateshop.competitors.horizon[4].dow" type="text" class="form-control" name="horizon15" ng-pattern="/^[0-9]*$/"/>
                                                </td>
                                                <td>
                                                    <input ng-model="newClientAdd.rateshop.competitors.horizon[5].days" ng-disabled="!newClientAdd.rateshop.competitors.horizon[5].dow" type="text" class="form-control" name="horizon16" ng-pattern="/^[0-9]*$/"/>
                                                </td>
                                                <td>
                                                    <input ng-model="newClientAdd.rateshop.competitors.horizon[6].days" ng-disabled="!newClientAdd.rateshop.competitors.horizon[6].dow" type="text" class="form-control" name="horizon17" ng-pattern="/^[0-9]*$/"/>
                                                </td>
                                            </tr>
                                        </table>
                                        <label for="horizon" class="form_errors" ng-show="presetting_form.horizon11.$invalid && !presetting_form.horizon11.$pristine || presetting_form.horizon12.$invalid && !presetting_form.horizon12.$pristine || presetting_form.horizon13.$invalid && !presetting_form.horizon13.$pristine || presetting_form.horizon14.$invalid && !presetting_form.horizon14.$pristine || presetting_form.horizon15.$invalid && !presetting_form.horizon15.$pristine || presetting_form.horizon16.$invalid && !presetting_form.horizon16.$pristine || presetting_form.horizon117.$invalid && !presetting_form.horizon17.$pristine">Please enter only digits</label>
                                    </div>
                                </div>
                            </div>
                            <hr />
                            <div class="panel-heading">Priority Settings</div>
                            <div class="col-md-5">
                                <div class="form-group">
                                    <label class="">Rate Types</label>
                                    <div class="border_sortable">
                                        <ul ui-sortable ui-sortable-update="update" ui-sortable-stop="stop" ng-model="newClientAdd.rateshop.ratetypes" ng-init="getRateTypesSortable()" class="list">
                                            <li ng-repeat="item in newClientAdd.rateshop.ratetypes" class="item">
                                                <span class="index_css">{{$index + 1}}</span>{{item.name}} 
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-5">
                                <div class="form-group">
                                    <label>Room Types</label>
                                    <div class="border_sortable">
                                        <ul ui-sortable ui-sortable-update="update" ui-sortable-stop="stop" ng-model="newClientAdd.rateshop.roomtypes" ng-init="getRoomTypesSortable()" class="list">
                                            <li ng-repeat="roomtype in newClientAdd.rateshop.roomtypes" class="item">
                                                <span class="index_css">{{$index + 1}}</span>   {{roomtype.name}}
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-primary pull-right" ng-click="rateshop_form_next(presetting_form.$valid)" style="margin-right:3px;">Next</button>
                    <button type="button" class="btn btn-danger pull-right" ng-click="rateshop_form_back(presetting_form.$valid)" style="margin-right:3px;">Back</button>
                </div>

                <div class="panel-body pr" ng-show="chmanager_form == true">
                    <div class="row form-group">
                        <div class="col-md-3">
                            <label>Hotel ID</label>
                             <div class='input-group'>            
                              <span class='input-group-addon'><i class="fa fa-building-o"></i></span>
                             <input type="text" name="manager_hotel_id" ng-model="newClientAdd.hotel_details.cm_hotel_id" class="form-control">
                            </div>
                        </div>
                        <div class="col-md-3">
                            <label>User ID</label>
                             <div class='input-group'>            
                              <span class='input-group-addon'><i class="fa fa-user"></i></span>
                             <input type="text" name="manager_id" ng-model="newClientAdd.hotel_details.cm_id" class="form-control">
                            </div>
                        </div>
                        <div class="col-md-3">
                            <label>Password</label>
                            <div class='input-group'>            
                              <span class='input-group-addon'><i class="fa fa-key"></i></span>
                            <input type="text" name="manager_password" ng-model="newClientAdd.hotel_details.cm_password" class="form-control">
                        </div>
                        </div>
                    </div>
                    <br>
                    <div ng-show="client_form.$invalid" class="alert alert-info text-left"><em>Please complete all the mandatory fields to submit this form.</em></div>
                    <div ng-show="success_msg" class="alert alert-success text-left">{{sub_message}}</div>
                    <div ng-show="danger_msg" class="alert alert-danger text-left">{{sub_message}}</div> 
                    
                    <div ng-show="addingClient" class='uil-ripple-css' style='transform:scale(0.6);position: absolute;transform:scale(0.6);right: 140px;bottom: -20px;'><div></div><div></div></div>
                    <button type="button" class="btn btn-primary pull-right" ng-disabled="client_form.$invalid || addingClient || success_msg" ng-click="addClient()" style="margin-right:3px;">Submit</button>
                    <button type="button" class="btn btn-danger pull-right" ng-click="chmanager_form_back()" style="margin-right:3px;">Back</button>
                </div>
            </section>
        </div>
    </div>
    <!-- page end-->
</section>
